<!-- Collapsed state -->
@if (collapsed()) {
  <div class="flex flex-col h-full">
    <!-- Toggle button -->
    <div class="p-2 border-b border-surface-200 dark:border-surface-800">
      <button
        class="flex items-center justify-center w-10 h-10 p-0 text-surface-500 bg-transparent border-none rounded-lg cursor-pointer transition-all duration-150 hover:text-surface-900 dark:hover:text-surface-50 hover:bg-surface-100 dark:hover:bg-surface-800"
        (click)="toggleCollapse.emit()"
        [title]="'SIDEBAR.EXPAND' | translate">
        <app-icon name="panel-left" [size]="20" />
      </button>
    </div>
    
    <!-- Icon-only actions -->
    <div class="flex flex-col items-center gap-1 p-2">
      <button
        class="flex items-center justify-center w-10 h-10 p-0 text-surface-500 bg-transparent border-none rounded-lg cursor-pointer transition-all duration-150 hover:text-accent hover:bg-accent-subtle dark:hover:bg-accent/20"
        (click)="openFile.emit()"
        [title]="'SIDEBAR.OPEN_ANOTHER' | translate">
        <app-icon name="folder" [size]="20" />
      </button>
      <button
        class="flex items-center justify-center w-10 h-10 p-0 text-surface-500 bg-transparent border-none rounded-lg cursor-pointer transition-all duration-150 hover:text-danger hover:bg-red-50 dark:hover:bg-red-950/50"
        (click)="closeFile.emit()"
        [title]="'SIDEBAR.CLOSE_FILE' | translate">
        <app-icon name="close" [size]="20" />
      </button>
    </div>
    
    <!-- All Mail icon -->
    <div class="flex-1 flex flex-col items-center gap-1 p-2 border-t border-surface-200 dark:border-surface-800">
      <button
        class="flex items-center justify-center w-10 h-10 p-0 border-none rounded-lg cursor-pointer transition-all duration-150"
        [class]="!selectedLabel() && !searchQuery()
          ? 'text-accent bg-accent-subtle dark:bg-accent/20'
          : 'text-surface-500 bg-transparent hover:text-surface-900 dark:hover:text-surface-50 hover:bg-surface-100 dark:hover:bg-surface-800'"
        (click)="labelClick.emit(null)"
        [title]="'SIDEBAR.ALL_MAIL' | translate">
        <app-icon name="mail" [size]="20" />
      </button>
    </div>
  </div>
} @else {
  <!-- Expanded state -->
  <div class="flex items-center gap-2 p-3 border-b border-surface-200 dark:border-surface-800">
    <button
      class="flex items-center justify-center w-8 h-8 p-0 text-surface-500 bg-transparent border-none rounded-lg cursor-pointer transition-all duration-150 hover:text-surface-900 dark:hover:text-surface-50 hover:bg-surface-100 dark:hover:bg-surface-800"
      (click)="toggleCollapse.emit()"
      [title]="'SIDEBAR.COLLAPSE' | translate">
      <app-icon name="panel-left" [size]="18" />
    </button>
    <span class="flex-1 text-sm font-semibold text-surface-900 dark:text-surface-50 truncate" [title]="currentPath() ?? ''">{{ formatFileName(currentPath()) }}</span>
    <button
      class="flex items-center justify-center w-8 h-8 p-0 text-surface-400 bg-transparent border-none rounded-lg cursor-pointer transition-all duration-150 hover:text-accent hover:bg-accent-subtle dark:hover:bg-accent/20"
      (click)="openFile.emit()"
      [title]="'SIDEBAR.OPEN_ANOTHER' | translate">
      <app-icon name="folder" [size]="18" />
    </button>
    <button
      class="flex items-center justify-center w-8 h-8 p-0 text-surface-400 bg-transparent border-none rounded-lg cursor-pointer transition-all duration-150 hover:text-danger hover:bg-red-50 dark:hover:bg-red-950/50"
      (click)="closeFile.emit()"
      [title]="'SIDEBAR.CLOSE_FILE' | translate">
      <app-icon name="close" [size]="18" />
    </button>
  </div>

  <app-sidebar-stats [stats]="stats()" />

  <app-label-nav
    [labels]="labels()"
    [selectedLabel]="selectedLabel()"
    [searchQuery]="searchQuery()"
    [totalMessages]="totalMessages"
    (labelClick)="labelClick.emit($event)" />

  <!-- Language switcher -->
  <div class="p-3 border-t border-surface-200 dark:border-surface-800 mt-auto">
    <app-language-switcher />
  </div>
}

