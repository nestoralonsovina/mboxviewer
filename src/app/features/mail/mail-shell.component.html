<div class="flex flex-col h-screen bg-white dark:bg-surface-900">
  <!-- Toolbar -->
  <app-search-toolbar
    [isSearching]="mbox.isSearching()"
    [searchResultsCount]="mbox.searchResultsCount()"
    [emailCount]="mbox.emails().length"
    (searchChange)="onSearchInput($event)"
    (clearSearch)="onClearSearch()" />

  <!-- Content Area -->
  <div class="flex-1 flex overflow-hidden">
    <!-- Email List -->
    <app-email-list
      [class]="mbox.selectedEmail()
        ? 'w-2/5 min-w-[320px] max-md:hidden border-r border-surface-200 dark:border-surface-800'
        : 'flex-1'"
      [emails]="mbox.emails()"
      [selectedEmail]="mbox.selectedEmail()"
      [isLoading]="mbox.loadingFile() || mbox.loadingEmails()"
      [isLoadingMore]="mbox.loadingMore()"
      [hasMore]="mbox.hasMore()"
      [searchQuery]="mbox.searchQuery()"
      [selectedLabel]="mbox.selectedLabel()"
      (emailClick)="onEmailClick($event)"
      (loadMore)="onLoadMore()" />

    <!-- Email Detail -->
    @let email = mbox.selectedEmail();
    @if (email) {
      <app-email-detail
        [email]="email"
        [emailBody]="mbox.selectedEmailBody()"
        [isLoading]="mbox.loadingEmailBody()"
        (closeDetail)="onCloseEmail()"
        (downloadAttachment)="onDownloadAttachment($event)" />
    }
  </div>
</div>
